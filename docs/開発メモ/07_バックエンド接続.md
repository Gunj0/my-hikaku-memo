# バックエンド接続

## バックエンド API を叩く API Route 実装

```ts
export async function GET(request: NextRequest): Promise<NextResponse> {
  try {
    // バックエンドAPIにGETリクエスト
    const res = await fetch(process.env.API_URL! + PATH.BACKEND.MEMO, {
      headers: {
        "Content-Type": "application/json",
        Authorization: `${request.headers.get("Authorization")}`,
      },
    });
    const resJson = await res.json();
    return NextResponse.json(resJson);
  } catch (error) {
    console.error("Error fetching backend API:", error);
    return NextResponse.json(
      { message: "Error fetching backend API" },
      { status: 500 }
    );
  }
}
```

## API Route を叩くメソッド実装

```ts: get-memos.ts
export async function getMemos(): Promise<string> {
  try {
    // JWTトークン取得
    const { data, error } = await authClient.token();
    if (error || !data) throw new Error(`トークン取得エラー: ${error.message}`);
    const jwtToken = data.token;

    // API Route リクエスト
    const result = await fetch(PATH.API.MEMO.LIST, {
      headers: {
        Authorization: `Bearer ${jwtToken}`,
      },
    });
    if (!result.ok) throw new Error(`内部エラー: ${result.text}`);

    // 成功したらJson化して返却
    const memos = await result.json();
    return JSON.stringify(memos);
  } catch (error: any) {
    return `その他エラー: ${error}`;
  }
}
```

##
